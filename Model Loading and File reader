{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[],"mount_file_id":"1ytAt1aQ_JK3RCRYZMtAr392nEuXxF1wO","authorship_tag":"ABX9TyPYqjTwWxt9J3RfdVnoUJ1E"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"54c741d5b0c6475bacecad447c64202f":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_6c8409748cbd4c33ad73d698c415e35f","IPY_MODEL_b56f9a6e4fea40cd97abc90f79787fc4","IPY_MODEL_885847d36cef437e987b1d78e33d7909"],"layout":"IPY_MODEL_7ffe386754c04d4fba4fc47464625780"}},"6c8409748cbd4c33ad73d698c415e35f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_054e6e2bae064867998a8e54377d6fff","placeholder":"​","style":"IPY_MODEL_0854a22b985a4fb8a6ac808d0b7b5005","value":"Loading weights: 100%"}},"b56f9a6e4fea40cd97abc90f79787fc4":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_fcc23fb5b3574d4ea8c347209ee0bdeb","max":291,"min":0,"orientation":"horizontal","style":"IPY_MODEL_d9e6110cf73845de8f55a2b27483b1f5","value":291}},"885847d36cef437e987b1d78e33d7909":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8f4759c6060749d3bca3a6f05083bac3","placeholder":"​","style":"IPY_MODEL_e916d3eb307a4ce3b46757a2789aed6e","value":" 291/291 [00:59&lt;00:00, 184.73it/s, Materializing param=model.norm.weight]"}},"7ffe386754c04d4fba4fc47464625780":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"054e6e2bae064867998a8e54377d6fff":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0854a22b985a4fb8a6ac808d0b7b5005":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"fcc23fb5b3574d4ea8c347209ee0bdeb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d9e6110cf73845de8f55a2b27483b1f5":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"8f4759c6060749d3bca3a6f05083bac3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e916d3eb307a4ce3b46757a2789aed6e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0ed1967602fd4ce68f134595d4770264":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_aeec08f20beb47659a601cd4f2e8179c","IPY_MODEL_0ca5271e223c498187b4cbae1ff39c26","IPY_MODEL_50ef54cf68814c769c1eef0ea5c3e7c3"],"layout":"IPY_MODEL_91a680d3c903406cb1186b649ea80d3f"}},"aeec08f20beb47659a601cd4f2e8179c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f328359a89a34733a665426ee7fcdaf5","placeholder":"​","style":"IPY_MODEL_a3088a4af8c74e69a7c84d942d12f394","value":"generation_config.json: 100%"}},"0ca5271e223c498187b4cbae1ff39c26":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_07a67488c431401eb6e08223aaf3a729","max":111,"min":0,"orientation":"horizontal","style":"IPY_MODEL_a888e8a1dc1648069d3b84270e3774cd","value":111}},"50ef54cf68814c769c1eef0ea5c3e7c3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c0843c3b451647a49ed1ea17693da358","placeholder":"​","style":"IPY_MODEL_b09ea08cd04b4510980110f5411fb398","value":" 111/111 [00:00&lt;00:00, 12.4kB/s]"}},"91a680d3c903406cb1186b649ea80d3f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f328359a89a34733a665426ee7fcdaf5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a3088a4af8c74e69a7c84d942d12f394":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"07a67488c431401eb6e08223aaf3a729":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a888e8a1dc1648069d3b84270e3774cd":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"c0843c3b451647a49ed1ea17693da358":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b09ea08cd04b4510980110f5411fb398":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_XBV_Tpt6kRy","executionInfo":{"status":"ok","timestamp":1772108885609,"user_tz":-330,"elapsed":9239,"user":{"displayName":"Kushal Das","userId":"18070567991537828552"}},"outputId":"26f08de4-4d43-4e48-bb90-fcb2dea66d89"},"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: transformers in /usr/local/lib/python3.12/dist-packages (5.0.0)\n","Collecting bitsandbytes\n","  Downloading bitsandbytes-0.49.2-py3-none-manylinux_2_24_x86_64.whl.metadata (10 kB)\n","Requirement already satisfied: accelerate in /usr/local/lib/python3.12/dist-packages (1.12.0)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.12/dist-packages (from transformers) (3.24.2)\n","Requirement already satisfied: huggingface-hub<2.0,>=1.3.0 in /usr/local/lib/python3.12/dist-packages (from transformers) (1.4.1)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.12/dist-packages (from transformers) (2.0.2)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.12/dist-packages (from transformers) (26.0)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.12/dist-packages (from transformers) (6.0.3)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.12/dist-packages (from transformers) (2025.11.3)\n","Requirement already satisfied: tokenizers<=0.23.0,>=0.22.0 in /usr/local/lib/python3.12/dist-packages (from transformers) (0.22.2)\n","Requirement already satisfied: typer-slim in /usr/local/lib/python3.12/dist-packages (from transformers) (0.24.0)\n","Requirement already satisfied: safetensors>=0.4.3 in /usr/local/lib/python3.12/dist-packages (from transformers) (0.7.0)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.12/dist-packages (from transformers) (4.67.3)\n","Requirement already satisfied: torch<3,>=2.3 in /usr/local/lib/python3.12/dist-packages (from bitsandbytes) (2.10.0+cu128)\n","Requirement already satisfied: psutil in /usr/local/lib/python3.12/dist-packages (from accelerate) (5.9.5)\n","Requirement already satisfied: fsspec>=2023.5.0 in /usr/local/lib/python3.12/dist-packages (from huggingface-hub<2.0,>=1.3.0->transformers) (2025.3.0)\n","Requirement already satisfied: hf-xet<2.0.0,>=1.2.0 in /usr/local/lib/python3.12/dist-packages (from huggingface-hub<2.0,>=1.3.0->transformers) (1.2.0)\n","Requirement already satisfied: httpx<1,>=0.23.0 in /usr/local/lib/python3.12/dist-packages (from huggingface-hub<2.0,>=1.3.0->transformers) (0.28.1)\n","Requirement already satisfied: shellingham in /usr/local/lib/python3.12/dist-packages (from huggingface-hub<2.0,>=1.3.0->transformers) (1.5.4)\n","Requirement already satisfied: typing-extensions>=4.1.0 in /usr/local/lib/python3.12/dist-packages (from huggingface-hub<2.0,>=1.3.0->transformers) (4.15.0)\n","Requirement already satisfied: setuptools in /usr/local/lib/python3.12/dist-packages (from torch<3,>=2.3->bitsandbytes) (75.2.0)\n","Requirement already satisfied: sympy>=1.13.3 in /usr/local/lib/python3.12/dist-packages (from torch<3,>=2.3->bitsandbytes) (1.14.0)\n","Requirement already satisfied: networkx>=2.5.1 in /usr/local/lib/python3.12/dist-packages (from torch<3,>=2.3->bitsandbytes) (3.6.1)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.12/dist-packages (from torch<3,>=2.3->bitsandbytes) (3.1.6)\n","Requirement already satisfied: cuda-bindings==12.9.4 in /usr/local/lib/python3.12/dist-packages (from torch<3,>=2.3->bitsandbytes) (12.9.4)\n","Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.8.93 in /usr/local/lib/python3.12/dist-packages (from torch<3,>=2.3->bitsandbytes) (12.8.93)\n","Requirement already satisfied: nvidia-cuda-runtime-cu12==12.8.90 in /usr/local/lib/python3.12/dist-packages (from torch<3,>=2.3->bitsandbytes) (12.8.90)\n","Requirement already satisfied: nvidia-cuda-cupti-cu12==12.8.90 in /usr/local/lib/python3.12/dist-packages (from torch<3,>=2.3->bitsandbytes) (12.8.90)\n","Requirement already satisfied: nvidia-cudnn-cu12==9.10.2.21 in /usr/local/lib/python3.12/dist-packages (from torch<3,>=2.3->bitsandbytes) (9.10.2.21)\n","Requirement already satisfied: nvidia-cublas-cu12==12.8.4.1 in /usr/local/lib/python3.12/dist-packages (from torch<3,>=2.3->bitsandbytes) (12.8.4.1)\n","Requirement already satisfied: nvidia-cufft-cu12==11.3.3.83 in /usr/local/lib/python3.12/dist-packages (from torch<3,>=2.3->bitsandbytes) (11.3.3.83)\n","Requirement already satisfied: nvidia-curand-cu12==10.3.9.90 in /usr/local/lib/python3.12/dist-packages (from torch<3,>=2.3->bitsandbytes) (10.3.9.90)\n","Requirement already satisfied: nvidia-cusolver-cu12==11.7.3.90 in /usr/local/lib/python3.12/dist-packages (from torch<3,>=2.3->bitsandbytes) (11.7.3.90)\n","Requirement already satisfied: nvidia-cusparse-cu12==12.5.8.93 in /usr/local/lib/python3.12/dist-packages (from torch<3,>=2.3->bitsandbytes) (12.5.8.93)\n","Requirement already satisfied: nvidia-cusparselt-cu12==0.7.1 in /usr/local/lib/python3.12/dist-packages (from torch<3,>=2.3->bitsandbytes) (0.7.1)\n","Requirement already satisfied: nvidia-nccl-cu12==2.27.5 in /usr/local/lib/python3.12/dist-packages (from torch<3,>=2.3->bitsandbytes) (2.27.5)\n","Requirement already satisfied: nvidia-nvshmem-cu12==3.4.5 in /usr/local/lib/python3.12/dist-packages (from torch<3,>=2.3->bitsandbytes) (3.4.5)\n","Requirement already satisfied: nvidia-nvtx-cu12==12.8.90 in /usr/local/lib/python3.12/dist-packages (from torch<3,>=2.3->bitsandbytes) (12.8.90)\n","Requirement already satisfied: nvidia-nvjitlink-cu12==12.8.93 in /usr/local/lib/python3.12/dist-packages (from torch<3,>=2.3->bitsandbytes) (12.8.93)\n","Requirement already satisfied: nvidia-cufile-cu12==1.13.1.3 in /usr/local/lib/python3.12/dist-packages (from torch<3,>=2.3->bitsandbytes) (1.13.1.3)\n","Requirement already satisfied: triton==3.6.0 in /usr/local/lib/python3.12/dist-packages (from torch<3,>=2.3->bitsandbytes) (3.6.0)\n","Requirement already satisfied: cuda-pathfinder~=1.1 in /usr/local/lib/python3.12/dist-packages (from cuda-bindings==12.9.4->torch<3,>=2.3->bitsandbytes) (1.3.4)\n","Requirement already satisfied: typer>=0.24.0 in /usr/local/lib/python3.12/dist-packages (from typer-slim->transformers) (0.24.0)\n","Requirement already satisfied: anyio in /usr/local/lib/python3.12/dist-packages (from httpx<1,>=0.23.0->huggingface-hub<2.0,>=1.3.0->transformers) (4.12.1)\n","Requirement already satisfied: certifi in /usr/local/lib/python3.12/dist-packages (from httpx<1,>=0.23.0->huggingface-hub<2.0,>=1.3.0->transformers) (2026.1.4)\n","Requirement already satisfied: httpcore==1.* in /usr/local/lib/python3.12/dist-packages (from httpx<1,>=0.23.0->huggingface-hub<2.0,>=1.3.0->transformers) (1.0.9)\n","Requirement already satisfied: idna in /usr/local/lib/python3.12/dist-packages (from httpx<1,>=0.23.0->huggingface-hub<2.0,>=1.3.0->transformers) (3.11)\n","Requirement already satisfied: h11>=0.16 in /usr/local/lib/python3.12/dist-packages (from httpcore==1.*->httpx<1,>=0.23.0->huggingface-hub<2.0,>=1.3.0->transformers) (0.16.0)\n","Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.12/dist-packages (from sympy>=1.13.3->torch<3,>=2.3->bitsandbytes) (1.3.0)\n","Requirement already satisfied: click>=8.2.1 in /usr/local/lib/python3.12/dist-packages (from typer>=0.24.0->typer-slim->transformers) (8.3.1)\n","Requirement already satisfied: rich>=12.3.0 in /usr/local/lib/python3.12/dist-packages (from typer>=0.24.0->typer-slim->transformers) (13.9.4)\n","Requirement already satisfied: annotated-doc>=0.0.2 in /usr/local/lib/python3.12/dist-packages (from typer>=0.24.0->typer-slim->transformers) (0.0.4)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.12/dist-packages (from jinja2->torch<3,>=2.3->bitsandbytes) (3.0.3)\n","Requirement already satisfied: markdown-it-py>=2.2.0 in /usr/local/lib/python3.12/dist-packages (from rich>=12.3.0->typer>=0.24.0->typer-slim->transformers) (4.0.0)\n","Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /usr/local/lib/python3.12/dist-packages (from rich>=12.3.0->typer>=0.24.0->typer-slim->transformers) (2.19.2)\n","Requirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.12/dist-packages (from markdown-it-py>=2.2.0->rich>=12.3.0->typer>=0.24.0->typer-slim->transformers) (0.1.2)\n","Downloading bitsandbytes-0.49.2-py3-none-manylinux_2_24_x86_64.whl (60.7 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m60.7/60.7 MB\u001b[0m \u001b[31m9.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: bitsandbytes\n","Successfully installed bitsandbytes-0.49.2\n"]}],"source":["!pip install transformers bitsandbytes accelerate\n"]},{"cell_type":"code","source":["from transformers import AutoModelForCausalLM, AutoTokenizer, BitsAndBytesConfig\n","import torch\n","\n","model_name = \"mistralai/Mistral-7B-Instruct-v0.2\"\n","\n","tokenizer = AutoTokenizer.from_pretrained(model_name)\n","\n","# Define 4-bit quantization configuration\n","quantization_config = BitsAndBytesConfig(\n","    load_in_4bit=True,\n","    bnb_4bit_quant_type=\"nf4\",\n","    bnb_4bit_compute_dtype=torch.bfloat16,\n","    bnb_4bit_use_double_quant=True,\n",")\n","\n","model = AutoModelForCausalLM.from_pretrained(\n","    model_name,\n","    device_map=\"auto\",\n","    quantization_config=quantization_config\n",")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":81,"referenced_widgets":["54c741d5b0c6475bacecad447c64202f","6c8409748cbd4c33ad73d698c415e35f","b56f9a6e4fea40cd97abc90f79787fc4","885847d36cef437e987b1d78e33d7909","7ffe386754c04d4fba4fc47464625780","054e6e2bae064867998a8e54377d6fff","0854a22b985a4fb8a6ac808d0b7b5005","fcc23fb5b3574d4ea8c347209ee0bdeb","d9e6110cf73845de8f55a2b27483b1f5","8f4759c6060749d3bca3a6f05083bac3","e916d3eb307a4ce3b46757a2789aed6e","0ed1967602fd4ce68f134595d4770264","aeec08f20beb47659a601cd4f2e8179c","0ca5271e223c498187b4cbae1ff39c26","50ef54cf68814c769c1eef0ea5c3e7c3","91a680d3c903406cb1186b649ea80d3f","f328359a89a34733a665426ee7fcdaf5","a3088a4af8c74e69a7c84d942d12f394","07a67488c431401eb6e08223aaf3a729","a888e8a1dc1648069d3b84270e3774cd","c0843c3b451647a49ed1ea17693da358","b09ea08cd04b4510980110f5411fb398"]},"id":"pHbCQf6m7AfG","executionInfo":{"status":"ok","timestamp":1772109242946,"user_tz":-330,"elapsed":66523,"user":{"displayName":"Kushal Das","userId":"18070567991537828552"}},"outputId":"a5c60796-4fb5-40ed-f090-fbf9421c176b"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["Loading weights:   0%|          | 0/291 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"54c741d5b0c6475bacecad447c64202f"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["generation_config.json:   0%|          | 0.00/111 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"0ed1967602fd4ce68f134595d4770264"}},"metadata":{}}]},{"cell_type":"code","source":["def call_llm(prompt):\n","    inputs = tokenizer(prompt, return_tensors=\"pt\").to(\"cuda\")\n","    outputs = model.generate(**inputs, max_new_tokens=300)\n","    return tokenizer.decode(outputs[0], skip_special_tokens=True)"],"metadata":{"id":"3NTvZybH8fq2"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2dbmPa3P8pYY","executionInfo":{"status":"ok","timestamp":1772115609053,"user_tz":-330,"elapsed":26958,"user":{"displayName":"Kushal Das","userId":"18070567991537828552"}},"outputId":"9034b572-87a9-4638-dd85-b6a1cdd4c3e2"},"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"code","source":["def read_file(filepath: str):\n","    try:\n","        with open(filepath, \"r\", encoding=\"utf-8\") as f:\n","            return f.read()\n","    except Exception as e:\n","        return f\"Error: {str(e)}\"\n","\n","def calculator(input: str):\n","    try:\n","        result = eval(input)\n","        return result # Added this line to return the calculated result\n","    except Exception as e:\n","        return f\"Error: {str(e)}\"\n","\n","system_prompt = \"\"\"\n","You are a local autonomous AI agent running inside a Python environment.\n","\n","You have direct access to tools through the controller.\n","\n","Available tools:\n","1. calculator(expression)\n","2. read_file(filepath)\n","\n","If a tool is required, respond ONLY in this format:\n","\n","TOOL: tool_name\n","INPUT: tool_input\n","\n","Do NOT write code.\n","Do NOT apologize.\n","Do NOT say you cannot access files.\n","You ARE allowed to read local files.\n","\"\"\""],"metadata":{"id":"G4mqVGxZ9Uha"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import re\n","\n","def _extract_llm_generated_content(full_response_from_llm, input_prompt_to_llm):\n","    \"\"\"\n","    Extracts only the LLM's generated content from a full response,\n","    handling cases where the LLM might prepend 'ASSISTANT:' or simply append to the prompt.\n","    \"\"\"\n","    # First, try to find and extract content after 'ASSISTANT:'\n","    llm_output_start_idx = full_response_from_llm.rfind(\"ASSISTANT:\")\n","    if llm_output_start_idx != -1:\n","        return full_response_from_llm[llm_output_start_idx + len(\"ASSISTANT:\"):].strip()\n","    else:\n","        # If 'ASSISTANT:' is not found, assume the LLM has echoed the input_prompt_to_llm\n","        # and its actual answer starts after that.\n","        # Use a stripped version of the prompt for a more robust comparison.\n","        stripped_input_prompt = input_prompt_to_llm.strip()\n","        stripped_full_response = full_response_from_llm.strip()\n","\n","        # Find the prompt in the response. Using re.escape for special characters.\n","        # We look for the prompt, followed by potentially some whitespace/newlines,\n","        # and then capture everything else.\n","        # The (?:...) creates a non-capturing group for the optional whitespace.\n","        match = re.search(re.escape(stripped_input_prompt) + r'(?:\\s*)(.*)', stripped_full_response, re.DOTALL)\n","        if match:\n","            # If a match is found, return the captured group (the content after the prompt), stripped.\n","            return match.group(1).strip()\n","        else:\n","            # Fallback: if prompt wasn't found as a prefix, return the whole response stripped.\n","            # This indicates an unexpected LLM behavior or a bug in parsing.\n","            return full_response_from_llm.strip()\n","\n","def agent(user_input):\n","\n","    full_prompt_1 = system_prompt + \"\\nUser: \" + user_input\n","\n","    # First LLM call\n","    response_with_prompt_1 = call_llm(full_prompt_1)\n","    # print(\"RAW LLM (1st call):\", response_with_prompt_1) # Suppressed for clarity\n","\n","    llm_generated_content_1 = _extract_llm_generated_content(response_with_prompt_1, full_prompt_1)\n","    # print(\"PARSING LLM GENERATED CONTENT (1st call):\", llm_generated_content_1) # Suppressed for clarity\n","\n","\n","    if \"TOOL:\" in llm_generated_content_1:\n","\n","        tool_name_match = re.search(r\"TOOL:\\s*(\\w+)\", llm_generated_content_1)\n","        tool_input_match = re.search(r\"INPUT:\\s*(.+)\", llm_generated_content_1, re.DOTALL)\n","\n","        if tool_name_match and tool_input_match:\n","            tool_name = tool_name_match.group(1)\n","            tool_input = tool_input_match.group(1).strip().strip(\"'\\\"\")\n","\n","            # print(\"Using tool:\", tool_name) # Suppressed for clarity\n","\n","            if tool_name == \"calculator\":\n","                tool_result = calculator(tool_input)\n","\n","            elif tool_name == \"read_file\":\n","                tool_result = read_file(tool_input)\n","\n","            else:\n","                return \"Unknown tool.\"\n","\n","            # Second LLM call with tool result\n","            second_prompt = f\"\"\"\n","You are an AI agent.\n","\n","User originally asked:\n","{user_input}\n","\n","Tool returned this data:\n","{tool_result}\n","\n","Now answer the user.\n","\"\"\"\n","            response_with_prompt_2 = call_llm(second_prompt)\n","            # print(\"RAW LLM (2nd call):\", response_with_prompt_2) # Suppressed for clarity\n","\n","            final_answer = _extract_llm_generated_content(response_with_prompt_2, second_prompt)\n","            # print(\"PARSING LLM GENERATED CONTENT (2nd call):\", final_answer) # Suppressed for clarity\n","\n","            return final_answer\n","\n","    return llm_generated_content_1 # Return the LLM's direct response if no tool was used"],"metadata":{"id":"GyZkx4-f9ZlT"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["Testing the Agent with \"Read the file FILE_PATH\""],"metadata":{"id":"cSwEWS4A9dfp"}},{"cell_type":"code","source":["print(agent(\"Read the file /content/drive/MyDrive/personal_projects/clawOPS/test.txt\"))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"DnXlaSOf9cU1","executionInfo":{"status":"ok","timestamp":1772111886291,"user_tz":-330,"elapsed":25228,"user":{"displayName":"Kushal Das","userId":"18070567991537828552"}},"outputId":"cf129ff7-97f0-49a3-a766-806c1512485c"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.\n","Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.\n"]},{"output_type":"stream","name":"stdout","text":["I have read the contents of the file /content/drive/MyDrive/personal_projects/clawOPS/test.txt for you. The text inside the file is as follows:\n","\n","Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.\n","\n","Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.\n","\n","Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.\n","Re Quis ipsum suspendisse ultrices gravida.\n"]}]},{"cell_type":"code","source":["print(agent(\"Calculate 8 * 9\"))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"JdqXo7PSFdxb","executionInfo":{"status":"ok","timestamp":1772111851120,"user_tz":-330,"elapsed":4660,"user":{"displayName":"Kushal Das","userId":"18070567991537828552"}},"outputId":"a03ca98c-99fc-4b2f-dfb8-301faebd5947"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.\n","Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.\n"]},{"output_type":"stream","name":"stdout","text":["I have calculated the product of 8 and 9, and the result is 72.\n"]}]},{"cell_type":"markdown","source":["Adding files directly to github"],"metadata":{"id":"UBm34wGiLUkd"}},{"cell_type":"code","source":["%cd /content/drive/MyDrive/personal_projects/clawOPS"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"QiNNg9lVT5Oa","executionInfo":{"status":"ok","timestamp":1772115637806,"user_tz":-330,"elapsed":16,"user":{"displayName":"Kushal Das","userId":"18070567991537828552"}},"outputId":"976a92c0-480c-4058-e59d-a0ff8d8a1439"},"execution_count":2,"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/MyDrive/personal_projects/clawOPS\n"]}]},{"cell_type":"code","source":["!ls -a"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"7QQUwSp0UssF","executionInfo":{"status":"ok","timestamp":1772115645626,"user_tz":-330,"elapsed":120,"user":{"displayName":"Kushal Das","userId":"18070567991537828552"}},"outputId":"74f6cdc8-3eb6-4c83-9dc2-185f4f5766cd"},"execution_count":3,"outputs":[{"output_type":"stream","name":"stdout","text":["'Model Loading and File reader'   test.txt\n"]}]},{"cell_type":"code","source":["!git init\n","!git branch -M main"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"DBd1mZHnT9d0","executionInfo":{"status":"ok","timestamp":1772115652949,"user_tz":-330,"elapsed":614,"user":{"displayName":"Kushal Das","userId":"18070567991537828552"}},"outputId":"1e216965-f4eb-47fc-bee7-0deccd888921"},"execution_count":4,"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[33mhint: Using 'master' as the name for the initial branch. This default branch name\u001b[m\n","\u001b[33mhint: is subject to change. To configure the initial branch name to use in all\u001b[m\n","\u001b[33mhint: of your new repositories, which will suppress this warning, call:\u001b[m\n","\u001b[33mhint: \u001b[m\n","\u001b[33mhint: \tgit config --global init.defaultBranch <name>\u001b[m\n","\u001b[33mhint: \u001b[m\n","\u001b[33mhint: Names commonly chosen instead of 'master' are 'main', 'trunk' and\u001b[m\n","\u001b[33mhint: 'development'. The just-created branch can be renamed via this command:\u001b[m\n","\u001b[33mhint: \u001b[m\n","\u001b[33mhint: \tgit branch -m <name>\u001b[m\n","Initialized empty Git repository in /content/drive/MyDrive/personal_projects/clawOPS/.git/\n"]}]},{"cell_type":"code","source":["!git remote add origin https://github.com/kushal-a11y/ClawOpsAIAgent.git"],"metadata":{"id":"_l1ig3KEUyZ5","executionInfo":{"status":"ok","timestamp":1772115668670,"user_tz":-330,"elapsed":107,"user":{"displayName":"Kushal Das","userId":"18070567991537828552"}}},"execution_count":5,"outputs":[]},{"cell_type":"code","source":["!git remote -v"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"qgtMvZccU0CZ","executionInfo":{"status":"ok","timestamp":1772115675491,"user_tz":-330,"elapsed":115,"user":{"displayName":"Kushal Das","userId":"18070567991537828552"}},"outputId":"18a3ba7c-2d64-4e3e-ee6e-3ebd0a651f4f"},"execution_count":6,"outputs":[{"output_type":"stream","name":"stdout","text":["origin\thttps://github.com/kushal-a11y/ClawOpsAIAgent.git (fetch)\n","origin\thttps://github.com/kushal-a11y/ClawOpsAIAgent.git (push)\n"]}]},{"cell_type":"code","source":["  git config --global user.email \"kushalstcet6.com\"\n","  git config --global user.name \"Your Name\""],"metadata":{"id":"psL448VKU_Td"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["!git config --global credential.helper store"],"metadata":{"id":"bx94g8dNU3p_","executionInfo":{"status":"ok","timestamp":1772115690516,"user_tz":-330,"elapsed":122,"user":{"displayName":"Kushal Das","userId":"18070567991537828552"}}},"execution_count":7,"outputs":[]},{"cell_type":"code","source":["!git add .\n","!git commit -m \"Initial commit\"\n","!git push -u origin main"],"metadata":{"id":"rnYJfbQFU7RX","executionInfo":{"status":"ok","timestamp":1772115707313,"user_tz":-330,"elapsed":1925,"user":{"displayName":"Kushal Das","userId":"18070567991537828552"}},"outputId":"e8829b5a-046f-4220-b8ed-ebb68a14cf35","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":8,"outputs":[{"output_type":"stream","name":"stdout","text":["Author identity unknown\n","\n","*** Please tell me who you are.\n","\n","Run\n","\n","  git config --global user.email \"you@example.com\"\n","  git config --global user.name \"Your Name\"\n","\n","to set your account's default identity.\n","Omit --global to set the identity only in this repository.\n","\n","fatal: unable to auto-detect email address (got 'root@7dca31cba40a.(none)')\n","error: src refspec main does not match any\n","\u001b[31merror: failed to push some refs to 'https://github.com/kushal-a11y/ClawOpsAIAgent.git'\n","\u001b[m"]}]}]}